---
title: "Discover 2015: workshopy a program"
output:
  html_document:
    css: custom.css
    fig_height: 8
    fig_width: 8
    number_sections: yes
---

Zpětná vazba Discover 2015 júl: workshopy a program
==================

----------

```{r Prep, echo=F, include=F}

library(knitr)
library(Cairo)
# set up graphing:
opts_chunk$set(echo=FALSE, dev='CairoPNG', warning=FALSE)
# make relative references work - change this to project directory
opts_knit$set(root.dir='~/github/experiments/d15eval/')

CairoFonts(
  regular="Gill Sans MT:style=Regular",
  bold="Gill Sans MT:style=Bold",
  italic="Gill Sans MT:style=Italic",
  bolditalic="Gill Sans MT:style=Bold Italic,BoldItalic",
  symbol="Symbol"
)

setwd("~/github/experiments/d15eval/")
source("./d15eval_setup.R")
setwd("~/github/experiments/d15eval/")
source("./d15eval_kurzy_setup.R")

loadcustomthemes(fontfamily = "Gill Sans MT")
theme_discover_multi <- theme(panel.grid.minor=element_line(color="grey96", size=.25),
                        panel.grid.major=element_line(color="white", size=.5),
                        strip.text = element_text(size=9, color="grey20", hjust=0.1),
                        panel.background = element_rect(fill="grey96"),
                        axis.text.x = element_text(size=10),
                        strip.background=element_rect(fill="grey96"),
                        plot.title=element_text(size=10, lineheight=0.5, hjust=0),
                        legend.key.width=unit(.3,"cm"))

theme_discover <- theme(panel.grid.minor=element_line(color="grey96", size=.2),
                        panel.grid.major=element_line(color="grey96", size=.3),
                        strip.text = element_text(size=12, color="grey20"),
                        panel.background = element_rect(fill="white"),
                        axis.text.x = element_text(size=11),
                        strip.background=element_rect(fill="white"),
                        legend.key.width=unit(.3,"cm"))

```

## Odpolední workshopy

```{r wsOdpoData}

wso <- data %>% 
  select(contains("wsOdpo"),vek,id,pohlavi, -contains("ejlep")) %>% 
  melt(id.vars=c("id","vek","pohlavi"))

```

### Nejlepší

```{r wsOdpo, echo=F, dev="CairoPNG",fig.cap="",dpi=200, fig.height=5, fig.retina=2}

wsonej <- data %>% 
  select(contains("wsOdpoNej"),vek,id,pohlavi)

wsonejsum <- data %>% 
  select(contains("wsOdpoNej"),vek,id,pohlavi) %>% 
  group_by(wsOdpoNejlepsi) %>% 
  summarise(pocet=n()) %>% 
  arrange(pocet)

ggplot(wsonejsum[!is.na(wsonejsum$wsOdpoNejlepsi),], aes(x=reorder(wsOdpoNejlepsi, pocet),y=pocet)) +
  geom_bar(stat="identity") +
  scale_y_continuous(limits=c(0,12), expand=c(0,0)) +
  coord_flip() + theme_discover + theme(panel.grid.major.y=element_blank())

```

### Hodnocení

```{r wsOdpoHodno, echo=F}



```


## Týmové workshopy

### Hodnocení

#### **Byly týmové workshopy zajímavé?**

```{r WStymHodn, echo=F, dev="CairoPNG",fig.cap="",dpi=200, fig.retina=2, fig.height=3, results="asis"}

tws <- data %>% 
  select(contains("wsTymove"),id,pohlavi,vek,rocnik) %>% 
  melt(id.vars=c("id","pohlavi","vek","rocnik")) 

twszaj <- tws %>% 
  filter(grepl("Q", .$variable)) %>% 
  group_by(variable, value) %>% 
  summarise(pocet=n())

twszaj$value <- as.factor(twszaj$value)
# levels(twszaj$value)
twszaj$value <- factor(twszaj$value, levels(twszaj$value)[c(5,3,1,2,4)])
# levels(twszaj$value)
twszaj <- arrange(twszaj, value) 

twszaj$variable <- plyr::revalue(twszaj$variable,
                                 c("wsTymoveZajimave_SQ004"="Co můžu dělat",
                                   "wsTymoveZajimave_SQ003"="Vtipy nebo ubližování slovem",
                                   "wsTymoveZajimave_SQ002"="Moje místo ve společnosti",
                                   "wsTymoveZajimave_SQ001"="Malé zločiny"
                                   ))

twszaj$variable <- factor(twszaj$variable, levels(twszaj$variable)[c(4,3,2,1)])

ggplot(twszaj, aes(group=variable, x=variable, y=pocet, fill=value,
                   order=-as.numeric(value))) +
  geom_bar(stat="identity", position="fill", color="grey96") + 
  coord_flip() +
  scale_fill_brewer(palette = "RdBu", breaks = rev(levels(twszaj$value))) +
  guides(fill = guide_legend(override.aes = list(colour = NULL))) +
  scale_y_continuous(labels=percent) +
  theme_discover + theme(panel.grid.major.y=element_blank(),
                         panel.grid.major.x=element_line(color="white"),
                         axis.text.y=element_text(size=12))
```

#### Proč ano, proč ne?

```{r echo=F, include=F}
tws <- data %>% 
  select(contains("wsTymove"),id,pohlavi,vek,rocnik,-contains("Time")) %>% 
  melt(id.vars=c("wsTymovePohled", "wsTymoveZmenit", "wsTymovePohled_comment",
                 "wsTymoveZmenit_comment", "id", "pohlavi", "vek", "rocnik",
                 "wsTymoveZajimaveProc")) %>% 
  mutate(ciselne=ifelse(value=="Určitě ano","1",
                        ifelse(value=="Spíše ano","2",
                               ifelse(value=="Nevím","3",
                                      ifelse(value=="Spíše ne","4",
                                             ifelse(value=="Určitě ne","5",value)))))) %>%
  group_by(id) %>% 
  mutate(meancis=mean(as.numeric(ciselne), na.rm=T),
         positive=meancis<3)
summary(tws$positive)
```

#### *Komentáře těch, kdo hodnotili spíše pozitivně*

```{r wsTymPozit, results="asis"}

cat(paste0("* ", unique(tws$wsTymoveZajimaveProc[!is.na(data$wsTymoveZajimaveProc) & tws$positive])),sep="\n")

```

#### *Komentáře těch, kdo hodnotili spíše negativně*

```{r wsTymNegat, results="asis"}

cat(paste0("* ", unique(tws$wsTymoveZajimaveProc[!is.na(data$wsTymoveZajimaveProc) & !tws$positive])),sep="\n")
```

### Dopad

#### Změnil se tvůj pohled na některé z témat?

```{r WStymDopad, results="asis"}

wsTymoveDopad <- data %>% group_by(wsTymovePohled) %>% summarise(pocet=n())
names(wsTymoveDopad) <- c("Změnil se tvůj pohled na některé z témat?"," ")

kable(wsTymoveDopad)

```

#### *Proč se pohled změnil:*

```{r wsTymoveProcZmenil, results="asis"}
cat(paste0("* ", data$wsTymovePohled_comment[!is.na(data$wsTymovePohled_comment) & data$wsTymovePohled=="Ano"]),sep="\n")
```

#### *Proč se pohled nezměnil:*

```{r wsTymoveProcNezmenil, results="asis"}
cat(paste0("* ", data$wsTymovePohled_comment[!is.na(data$wsTymovePohled_comment) & data$wsTymovePohled=="Ne"]),sep="\n")
```

### Máme týmové workshopy změnit? Pokud ano, jak?

```{r wsTymZmenit, echo=F, dev="CairoPNG",fig.cap="",dpi=200, fig.retina=2, fig.height=12, results="asis"}

wsTymoveZmenit <- data %>% group_by(wsTymoveZmenit) %>% summarise(pocet=n())
names(wsTymoveZmenit) <- c("Máme týmové workshopy měnit?"," ")

kable(wsTymoveZmenit)
```

#### *Co změnit:*

```{r wsTymZmenitAno, results="asis"}
cat(paste0("* ", unique(data$wsTymoveZmenit_comment[!is.na(data$wsTymoveZmenit_comment) & data$wsTymoveZmenit=="Ano"])),sep="\n")
```

#### *Proč nic neměnit:*

```{r wsTymZmenitNe, results="asis"}
cat(paste0("* ", unique(data$wsTymoveZmenit_comment[!is.na(data$wsTymoveZmenit_comment) & data$wsTymoveZmenit=="Ne"])),sep="\n")
```

## Prefekti

### Hodnocení role

## Večerní (karierní) workshopy

### Účast

### Hodnocení

### Který byl nejlepší?

## Večerní program

```{r Vecer, echo=F, dev="CairoPNG",fig.cap="",dpi=200, fig.retina=2}



```

# Program obecně

```{r Program, echo=F, dev="CairoPNG",fig.cap="",dpi=200, fig.retina=2}


```

## Komunikace

### Před Discover

### Brožurka