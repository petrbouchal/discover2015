---
title: 'Discover 2015 august: workshopy a program'
output:
  html_document:
  css: custom.css
fig_height: 8
fig_width: 8
number_sections: no
toc: yes
toc_depth: 1
---
  
Discover 2015 august: workshopy, týmy, prefekti
=============
----------
  
*[Zpět na rozcestník zpětné vazby](index.html)*
  
  
```{r PrepWorkshopy, echo=F, include=F}

library(knitr)
library(Cairo)
# set up graphing:
opts_chunk$set(echo=FALSE, dev='CairoPNG', warning=FALSE)
# make relative references work - change this to project directory
opts_knit$set(root.dir='~/github/discover2015/d15eval/')

CairoFonts(
  regular="Gill Sans MT:style=Regular",
  bold="Gill Sans MT:style=Bold",
  italic="Gill Sans MT:style=Italic",
  bolditalic="Gill Sans MT:style=Bold Italic,BoldItalic",
  symbol="Symbol"
)

setwd("~/github/discover2015/d15eval/")
source("./d15eval_setup.R")
setwd("~/github/discover2015/d15eval/")
```

# Odpolední workshopy

## Který byl nejlepší?

*coming soon*


```{r wsOdpoNejJine, include=F, echo=F, eval=F}

wsonej <- df2 %>% 
  select(contains("wsOdpoNej"),vek,id,pohlavi,-contains("Time"))

# Co nám napsali ti, co vybrali "žádný" nebo nevybrali nic?

wsonej[is.na(wsonej$wsOdpoNejlepsi) & !is.na(wsonej$wsOdpoNejlepsi_comment),2]
wsonej$wsOdpoNejlepsi_comment[wsonej$wsOdpoNejlepsi=="Žádný" & !is.na(wsonej$wsOdpoNejlepsi_comment)]

# Fill in where comment contains identifiable workshop reference
wsonej$wsOdpoNejlepsi <- as.character(wsonej$wsOdpoNejlepsi)
wsonej$wsOdpoNejlepsi[grepl("urnalist",wsonej$wsOdpoNejlepsi_comment,ignore.case = T)] <- "Žurnalistika"
wsonej$wsOdpoNejlepsi[grepl("prvej",wsonej$wsOdpoNejlepsi_comment,ignore.case = T)] <- "Prvá pomoc"
wsonej$wsOdpoNejlepsi <- as.factor(wsonej$wsOdpoNejlepsi)
unique(wsonej$wsOdpoNejlepsi)
```

```{r wsOdpoNej, echo=F, dev="CairoPNG",fig.cap="",dpi=200, fig.height=5, fig.retina=2, eval=F}
wsonejsum <- wsonej %>% 
  group_by(wsOdpoNejlepsi) %>% 
  summarise(pocet=n()) %>% 
  arrange(pocet, desc(wsOdpoNejlepsi))

ggplot(wsonejsum[!is.na(wsonejsum$wsOdpoNejlepsi),], aes(x=reorder(wsOdpoNejlepsi, pocet),y=pocet)) +
  geom_bar(stat="identity", fill="darkgrey") +
  scale_y_continuous(limits=c(0,12), expand=c(0,0)) +
  coord_flip() + theme_discover + theme(panel.grid.major.y=element_blank(),
                                        panel.grid.major.x=element_line(colour="grey92"),
                                        panel.grid.minor.x=element_blank())
```


## Proč?

*coming soon*
  
## Hodnocení
  
Nejlépe hodnocené workshopy jsou nahoře. Známky jako ve škole.

*coming soon*

```{r wsOdpoHodno, echo=F, dpi=200, dev="CairoPNG", fig.retina=2, fig.height=6, eval=F}
library(RColorBrewer)

wso <- df2 %>% 
  select(contains("wsOdpo"),-contains("Time"),-contains("lepsi"), id, vek, rocnik, pohlavi,
         poprve=minulerocniky_prvno)

names(wso) <- sub("Ktery","_nazev",names(wso))
names(wso) <- sub("_nazev_other","_other",names(wso))
names(wso) <- sub("Hodn","_hodn",names(wso))

wso0 <- wso %>% 
  melt(id.vars=c("id","pohlavi","vek","rocnik","poprve")) %>% 
  separate(variable, c("den","variable"), sep="_") %>% 
  spread(variable,value) %>% 
  mutate(den=gsub("wsOdpo","",den),
         den=tolower(den))

# look at all where "other" was filled in
wso_other <- wso0 %>% filter(!is.na(other))

# fill in those where "other" refers to a recognizable workshop (identified manually)

wso0$nazev[grepl("ism",wso0$other,ignore.case = T)] <- "Radikalismus (host)"
wso0$nazev[grepl("izm",wso0$other,ignore.case = T)] <- "Radikalismus (host)"
wso0$nazev[grepl("naci",wso0$other,ignore.case = T)] <- "Radikalismus (host)"
wso0$nazev[grepl("ebat",wso0$other,ignore.case = T)] <- "Debata (workshop)"
wso0$nazev[grepl("alov",wso0$other,ignore.case = T)] <- "Malování na trička"
wso0$nazev[grepl("Novin",wso0$other,ignore.case = T)] <- "Žurnalistika"
wso0$nazev[grepl("Volby a ich prieskumy",wso0$other,ignore.case = T)] <- "Volby a voliči: páteř demokracie, nebo její Achillova pata?"
wso0$nazev[grepl("štastie",wso0$other,ignore.case = T)] <- "Dá se štěstí koupit?"
wso0$nazev[grepl("sociol",wso0$other,ignore.case = T)] <- "Sociologie lásky: koho milujeme a jaké to má dopady na společnost"

# Summarise

wso <- wso0 %>% 
  filter(!is.na(nazev)) %>% 
  group_by(nazev) %>% 
  mutate(znamka=mean(as.numeric(hodn), na.rm=T), pocet=n(),
         minzn=min(hodn, na.rm=T), maxzn=max(hodn, na.rm=T)) %>% 
  group_by(nazev, hodn) %>% 
  summarise(znamka=mean(znamka,na.rm=T), pocetznamka=n())

wso$nazev <- factor(wso$nazev, levels=wso$nazev[order(-wso$znamka)])
wso <- arrange(wso, hodn)

ggplot(wso, aes(y=as.numeric(pocetznamka), x=nazev, fill=hodn, group=nazev)) +
  geom_bar(stat="identity", position="stack") +
  scale_fill_manual(values = rev(brewer.pal(5,"RdYlGn"))) +
  coord_flip() + theme_discover + theme(panel.grid.major.y=element_blank(),
                                        panel.grid.major.x=element_line(colour="grey92"),
                                        panel.grid.minor.x=element_line(colour="grey96"))


```

----
  
# Týmové workshopy

## Hodnocení

### **Byly týmové workshopy zajímavé?**

```{r wsTymHodn, echo=F, dev="CairoPNG",fig.cap="",dpi=200, fig.retina=2, fig.height=3, results="asis"}

tws <- df2 %>% 
  select(contains("wsTymove"),id,pohlavi,vek,rocnik, poprve=minulerocniky_prvno) %>% 
  melt(id.vars=c("id","pohlavi","vek","rocnik","poprve")) 

twszaj <- tws %>% 
  filter(grepl("Q", .$variable)) %>% 
  group_by(variable, value) %>% 
  summarise(pocet=n())

twszaj$value <- as.factor(twszaj$value)
# levels(twszaj$value)
twszaj$value <- factor(twszaj$value, levels(twszaj$value)[c(5,3,1,2,4)])
# levels(twszaj$value)
twszaj <- arrange(twszaj, value) 

twszaj$variable <- plyr::revalue(twszaj$variable,
                                 c("wsTymoveZajimave_SQ005b"="Reflexe Discoveru (so)",
                                   "wsTymoveZajimave_SQ004b"="Moje místo ve společnosti (pá)",
                                   "wsTymoveZajimave_SQ003b"="Malé zločiny (st)",
                                   "wsTymoveZajimave_SQ002b"="Večer za oponou (út)",
                                   "wsTymoveZajimave_SQ001b"="Psychologie zla (po)"
                                 ))

twszaj$variable <- factor(twszaj$variable, levels(twszaj$variable)[c(5,4,3,2,1)])

ggplot(twszaj, aes(group=variable, x=variable, y=pocet, fill=value,
                   order=-as.numeric(value))) +
  geom_bar(stat="identity", position="fill", color="grey96") + 
  coord_flip() +
  scale_fill_brewer(palette = "RdBu", breaks = rev(levels(twszaj$value))) +
  guides(fill = guide_legend(override.aes = list(colour = NULL))) +
  scale_y_continuous(labels=percent) +
  theme_discover + theme(panel.grid.major.y=element_blank(),
                         panel.grid.major.x=element_line(color="white"),
                         axis.text.y=element_text(size=12))
```

### **Hodnocení týmových workshopů podle předchozí účasti na Discover**

```{r wsTymHodnProc, echo=F, include=F}
tws <- df2 %>% 
  select(contains("wsTymove"),id,pohlavi,vek,rocnik,-contains("Time"),
         poprve=minulerocniky_prvno) %>% 
  melt(id.vars=c("wsTymovePohled", "wsTymoveZmenit", "wsTymovePohled_comment",
                 "wsTymoveZmenit_comment", "id", "pohlavi", "vek", "rocnik",
                 "wsTymoveZajimaveProc","poprve")) %>% 
  mutate(ciselne=ifelse(value=="Určitě ano","1",
                        ifelse(value=="Spíše ano","2",
                               ifelse(value=="Nevím","3",
                                      ifelse(value=="Spíše ne","4",
                                             ifelse(value=="Určitě ne","5",value))))),
         poprve=ifelse(poprve=="Ano","Na Discover poprvé","Na Discover nejméně podruhé")) %>%
  group_by(id, poprve, wsTymovePohled, wsTymoveZmenit, wsTymoveZajimaveProc,
           wsTymovePohled_comment, wsTymoveZajimaveProc, wsTymoveZmenit_comment) %>% 
  summarise(meancis=mean(as.numeric(ciselne), na.rm=T)) %>% 
  ungroup() %>% 
  mutate(positive=(meancis<mean(meancis, na.rm=T)))
summary(tws$positive)
```

```{r wsTymHodnPodleUcasti, results="asis", warnings=F}
suppressPackageStartupMessages(library(stargazer))

hodnpodleucasti <- group_by(tws, poprve) %>%
  summarise(hodn=mean(meancis, na.rm=T), pocet=n())
names(hodnpodleucasti) <- c("Předchozí účast",
                            "Hodnocení (1=Určitě zajímavé, 5=Určitě nezajímavé)",
                            "Počet účastníků")
# kable(hodnpodleucasti, digits=2)

stargazer(as.matrix(format(hodnpodleucasti, quote=FALSE,
                           justify="right",digits=3), rownames.force = FALSE),
          type="html", dep.var.labels.include = FALSE, digits=2)
```

### Proč ano, proč ne?


### *Komentáře těch, kdo hodnotili spíše pozitivně*

```{r wsTymPozit, results="asis"}

cat(paste0("* ", unique(tws$wsTymoveZajimaveProc[!is.na(df2$wsTymoveZajimaveProc) & tws$positive])),sep="\n")

```

### *Komentáře těch, kdo hodnotili spíše negativně*

```{r wsTymNegat, results="asis"}

cat(paste0("* ", unique(tws$wsTymoveZajimaveProc[!is.na(df2$wsTymoveZajimaveProc) & !tws$positive])),sep="\n")
```

## Dopad týmových workshopů

### Změnil se tvůj pohled na některé z témat?

```{r wsTymovePohled, echo=F, dev="CairoPNG",fig.cap="",dpi=200, fig.retina=2, fig.height=12, results="asis"}

wsTymovePohled <- select(df2, pohled=wsTymovePohled, poprve=minulerocniky_prvno) %>% 
  mutate(pohled=ifelse(pohled=="Ano","Změnil","Nezměnil"),
         poprve=ifelse(poprve=="Ano","Na Discoveru poprvé","Na Discoveru nejméně podruhé"))

library(stargazer)
ttt <- table(wsTymovePohled)
ttt <- addmargins(ttt)
row.names(ttt)[3] <- "Celkem"
colnames(ttt)[3] <- "Celkem"
f <- t(ttt)
stargazer(format(f, quote=FALSE, justify="right"), type="html", dep.var.labels.include = FALSE)
```

### *Proč se pohled změnil:*

```{r wsTymoveProcZmenil, results="asis"}
cat(paste0("* ", df2$wsTymovePohled_comment[!is.na(df2$wsTymovePohled_comment) & df2$wsTymovePohled=="Ano"]),sep="\n")
```

### *Proč se pohled nezměnil:*

```{r wsTymoveProcNezmenil, results="asis"}
cat(paste0("* ", df2$wsTymovePohled_comment[!is.na(df2$wsTymovePohled_comment) & df2$wsTymovePohled=="Ne"]),sep="\n")
```

## Máme týmové workshopy změnit? Pokud ano, jak?

```{r wsTymZmenit, echo=F, dev="CairoPNG",fig.cap="",dpi=200, fig.retina=2, fig.height=12, results="asis"}

wsTymoveZmenit <- select(df2, zmenit=wsTymoveZmenit, poprve=minulerocniky_prvno) %>% 
  mutate(zmenit=ifelse(zmenit=="Ano","Změnit","Neměnit"),
         poprve=ifelse(poprve=="Ano","Na Discoveru poprvé","Na Discoveru nejméně podruhé"))

library(stargazer)
ttt <- table(wsTymoveZmenit)
ttt <- addmargins(ttt)
row.names(ttt)[3] <- "Celkem"
colnames(ttt)[3] <- "Celkem"
f <- t(ttt)
stargazer(format(f, quote=FALSE, justify="right"), type="html", dep.var.labels.include = FALSE)
```

Tedy: častěji by týmové workshopy měnili ti, kdo už Discover zažili.

### *Co změnit:*

```{r wsTymZmenitAno, results="asis"}
cat(paste0("* ", unique(df2$wsTymoveZmenit_comment[!is.na(df2$wsTymoveZmenit_comment) & df2$wsTymoveZmenit=="Ano"])),sep="\n")
```

### *Proč nic neměnit:*

```{r wsTymZmenitNe, results="asis"}
cat(paste0("* ", unique(df2$wsTymoveZmenit_comment[!is.na(df2$wsTymoveZmenit_comment) & df2$wsTymoveZmenit=="Ne"])),sep="\n")
```

----
  
# Prefekti

*coming soon*

## Hodnocení role

*coming soon*

----
# Večerní (kariérní) workshopy

*coming soon*

## Který byl nejlepší?


```{r wsVecerNej, echo=F, dev="CairoPNG",fig.cap="",dpi=200, fig.retina=2, fig.height=5, results="asis", eval=F}

wsvnej <- df2 %>% 
  select(contains("wsVecerNej"),vek,id,pohlavi)

wsvnejsum <- df2 %>% 
  select(contains("wsVecernej"),contains("weVecerNej"),vek,id,pohlavi,
         poprve=minulerocniky_prvno) %>% 
  group_by(wsVecernejlepsi) %>% 
  summarise(pocet=n()) %>% 
  arrange(pocet)

ggplot(wsvnejsum[!is.na(wsvnejsum$wsVecernejlepsi),],
       aes(x=reorder(wsVecernejlepsi, pocet),y=pocet)) +
  geom_bar(stat="identity", fill="darkblue") +
  scale_y_continuous(limits=c(0,30), expand=c(0,0)) +
  coord_flip() + theme_discover + 
  theme(panel.grid.major.y=element_blank(),
        panel.grid.major.x=element_line(colour="grey92"),
        panel.grid.minor.x=element_blank())

```

## Proč?

*coming soon*
  
## Hodnocení

*coming soon*

Nejlépe hodnocené workshopy jsou v grafu nahoře.

```{r wsVecerHodn, echo=F, dev="CairoPNG",fig.cap="",dpi=200, fig.retina=2, fig.height=6, results="asis", eval=F}

wsv <- df2 %>% 
  select(contains("wsVecer"),-contains("Time"),-contains("lepsi"), id, vek, rocnik, pohlavi,
         poprve=minulerocniky_prvno)

names(wsv) <- sub("Ktery","_nazev",names(wsv))
names(wsv) <- sub("_nazev_other","_other",names(wsv))
names(wsv) <- sub("Hodn","_hodn",names(wsv))

wsv0 <- wsv %>% 
  melt(id.vars=c("id","pohlavi","vek","rocnik","poprve")) %>% 
  separate(variable, c("den","variable"), sep="_") %>% 
  spread(variable,value) %>% 
  mutate(den=gsub("wsVecer","",den),
         den=tolower(den))

# Co vyplnili, kdyz vyplnili "jine?"
wsv_other <- wsv0 %>% filter(is.na(nazev) & !is.na(other))
# odpoved: nic moc

wsv <- wsv0 %>% 
  filter(!is.na(nazev)) %>% 
  filter(nazev!="Žádný") %>% 
  group_by(nazev) %>% 
  mutate(znamka=mean(as.numeric(hodn), na.rm=T), pocet=n(),
         minzn=min(hodn, na.rm=T), maxzn=max(hodn, na.rm=T),
         hodn=ifelse(is.na(hodn),"0",hodn)) %>% 
  group_by(nazev, hodn) %>% 
  summarise(pocetznamka=n(), znamka=mean(znamka))

wsv$nazev <- factor(wsv$nazev, levels=wsv$nazev[order(-wsv$znamka)])
wsv <- arrange(wsv, hodn)

ggplot() +
  geom_bar(data=wsv, aes(pocetznamka, x=nazev, fill=hodn, group=nazev),
           stat="identity", position="stack") +
  scale_fill_manual(values = c("darkgrey",rev(brewer.pal(5,"RdYlGn")))) +
  coord_flip() + theme_discover +
  theme(panel.grid.major.y=element_blank(),
        panel.grid.major.x=element_line(colour="grey92"),
        panel.grid.minor.x=element_line(colour="grey96"))

```